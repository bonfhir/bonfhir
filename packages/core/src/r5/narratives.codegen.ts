/**
 * Narrative generators for r5/5.0.0
 */

/* eslint-disable @typescript-eslint/no-explicit-any */
import { AnyDomainResource, Narrative } from "@bonfhir/fhirtypes/r5";
import { DefaultFormatter, Formatter } from "./formatters";
import { startCase } from "./lang-utils";

/** Attribute name, FHIR Type */
export type NarrativeItemGenerator = [string, string];

export type NarrativeGenerator =
  | NarrativeItemGenerator[]
  | ((resource: any) => Narrative | string);

export interface NarrativeOptions {
  /** The formatter to use. Will use the `Formatter.default` if not provided. */
  formatter?: DefaultFormatter | null | undefined;
}

export const NARRATIVE_GENERATORS: Record<string, NarrativeGenerator> = {
  Account: [
    ["billingStatus", "CodeableConcept"],
    ["coverage", "AccountCoverage"],
    ["description", "markdown"],
    ["diagnosis", "AccountDiagnosis"],
    ["identifier", "Identifier"],
    ["name", "string"],
    ["owner", "Reference"],
    ["procedure", "AccountProcedure"],
    ["servicePeriod", "Period"],
    ["status", "code"],
    ["subject", "Reference"],
    ["type", "CodeableConcept"],
  ],
  AccountCoverage: [
    ["coverage", "Reference"],
    ["modifierExtension", "Extension"],
    ["priority", "positiveInt"],
  ],
  AccountDiagnosis: [
    ["condition", "CodeableReference"],
    ["modifierExtension", "Extension"],
  ],
  AccountProcedure: [
    ["code", "CodeableReference"],
    ["device", "Reference"],
    ["modifierExtension", "Extension"],
  ],
  ActivityDefinition: [
    ["asNeededBoolean", "boolean"],
    ["asNeededCodeableConcept", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["description", "markdown"],
    ["doNotPerform", "boolean"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["kind", "code"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  ActorDefinition: [
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["type", "code"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  AdministrableProductDefinition: [
    ["administrableDoseForm", "CodeableConcept"],
    ["device", "Reference"],
    ["formOf", "Reference"],
    ["identifier", "Identifier"],
    ["ingredient", "CodeableConcept"],
    ["producedFrom", "Reference"],
    ["property", "AdministrableProductDefinitionProperty"],
    [
      "routeOfAdministration",
      "AdministrableProductDefinitionRouteOfAdministration",
    ],
    ["status", "code"],
    ["unitOfPresentation", "CodeableConcept"],
  ],
  AdministrableProductDefinitionProperty: [
    ["modifierExtension", "Extension"],
    ["status", "CodeableConcept"],
    ["type", "CodeableConcept"],
    ["valueCodeableConcept", "CodeableConcept"],
    ["valueQuantity", "Quantity"],
    ["valueDate", "date"],
    ["valueBoolean", "boolean"],
    ["valueMarkdown", "markdown"],
    ["valueAttachment", "Attachment"],
    ["valueReference", "Reference"],
  ],
  AdministrableProductDefinitionRouteOfAdministration: [
    ["code", "CodeableConcept"],
    ["firstDose", "Quantity"],
    ["maxDosePerDay", "Quantity"],
    ["maxDosePerTreatmentPeriod", "Ratio"],
    ["maxSingleDose", "Quantity"],
    ["maxTreatmentPeriod", "Duration"],
    ["modifierExtension", "Extension"],
    [
      "targetSpecies",
      "AdministrableProductDefinitionRouteOfAdministrationTargetSpecies",
    ],
  ],
  AdministrableProductDefinitionRouteOfAdministrationTargetSpecies: [
    ["code", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    [
      "withdrawalPeriod",
      "AdministrableProductDefinitionRouteOfAdministrationTargetSpeciesWithdrawalPeriod",
    ],
  ],
  AdministrableProductDefinitionRouteOfAdministrationTargetSpeciesWithdrawalPeriod:
    [
      ["modifierExtension", "Extension"],
      ["supportingInformation", "string"],
      ["tissue", "CodeableConcept"],
      ["value", "Quantity"],
    ],
  AdverseEvent: [
    ["actuality", "code"],
    ["category", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["contributingFactor", "AdverseEventContributingFactor"],
    ["detected", "dateTime"],
    ["encounter", "Reference"],
    ["identifier", "Identifier"],
    ["location", "Reference"],
    ["mitigatingAction", "AdverseEventMitigatingAction"],
    ["note", "Annotation"],
    ["occurrenceDateTime", "dateTime"],
    ["occurrencePeriod", "Period"],
    ["occurrenceTiming", "Timing"],
    ["outcome", "CodeableConcept"],
    ["participant", "AdverseEventParticipant"],
    ["preventiveAction", "AdverseEventPreventiveAction"],
    ["recordedDate", "dateTime"],
    ["recorder", "Reference"],
    ["resultingEffect", "Reference"],
    ["seriousness", "CodeableConcept"],
    ["status", "code"],
    ["study", "Reference"],
    ["subject", "Reference"],
    ["supportingInfo", "AdverseEventSupportingInfo"],
    ["suspectEntity", "AdverseEventSuspectEntity"],
  ],
  AdverseEventContributingFactor: [
    ["itemReference", "Reference"],
    ["itemCodeableConcept", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  AdverseEventMitigatingAction: [
    ["itemReference", "Reference"],
    ["itemCodeableConcept", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  AdverseEventParticipant: [
    ["actor", "Reference"],
    ["function", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  AdverseEventPreventiveAction: [
    ["itemReference", "Reference"],
    ["itemCodeableConcept", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  AdverseEventSupportingInfo: [
    ["itemReference", "Reference"],
    ["itemCodeableConcept", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  AdverseEventSuspectEntity: [
    ["causality", "AdverseEventSuspectEntityCausality"],
    ["instanceCodeableConcept", "CodeableConcept"],
    ["instanceReference", "Reference"],
    ["modifierExtension", "Extension"],
  ],
  AdverseEventSuspectEntityCausality: [
    ["assessmentMethod", "CodeableConcept"],
    ["author", "Reference"],
    ["entityRelatedness", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  AllergyIntolerance: [
    ["category", "code"],
    ["clinicalStatus", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["criticality", "code"],
    ["identifier", "Identifier"],
    ["participant", "AllergyIntoleranceParticipant"],
    ["patient", "Reference"],
    ["type", "CodeableConcept"],
    ["verificationStatus", "CodeableConcept"],
  ],
  AllergyIntoleranceParticipant: [
    ["actor", "Reference"],
    ["function", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  Appointment: [
    ["appointmentType", "CodeableConcept"],
    ["cancellationReason", "CodeableConcept"],
    ["class", "CodeableConcept"],
    ["end", "instant"],
    ["identifier", "Identifier"],
    ["reason", "CodeableReference"],
    ["serviceCategory", "CodeableConcept"],
    ["serviceType", "CodeableReference"],
    ["specialty", "CodeableConcept"],
    ["start", "instant"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  AppointmentResponse: [
    ["actor", "Reference"],
    ["appointment", "Reference"],
    ["identifier", "Identifier"],
    ["participantStatus", "code"],
    ["participantType", "CodeableConcept"],
    ["proposedNewTime", "boolean"],
  ],
  ArtifactAssessment: [
    ["artifactReference", "Reference"],
    ["artifactCanonical", "canonical"],
    ["artifactUri", "uri"],
    ["date", "dateTime"],
    ["disposition", "code"],
    ["identifier", "Identifier"],
    ["lastReviewDate", "date"],
    ["title", "string"],
    ["workflowStatus", "code"],
  ],
  AuditEvent: [
    ["action", "code"],
    ["agent", "AuditEventAgent"],
    ["authorization", "CodeableConcept"],
    ["category", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["entity", "AuditEventEntity"],
    ["outcome", "AuditEventOutcome"],
    ["recorded", "instant"],
    ["severity", "code"],
    ["source", "AuditEventSource"],
  ],
  AuditEventAgent: [
    ["modifierExtension", "Extension"],
    ["requestor", "boolean"],
    ["who", "Reference"],
  ],
  AuditEventEntity: [
    ["modifierExtension", "Extension"],
    ["query", "base64Binary"],
    ["what", "Reference"],
  ],
  AuditEventOutcome: [
    ["code", "Coding"],
    ["detail", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  AuditEventSource: [
    ["modifierExtension", "Extension"],
    ["observer", "Reference"],
  ],
  Basic: [
    ["author", "Reference"],
    ["code", "CodeableConcept"],
    ["created", "dateTime"],
    ["identifier", "Identifier"],
    ["subject", "Reference"],
  ],
  BiologicallyDerivedProduct: [
    ["biologicalSourceEvent", "Identifier"],
    ["identifier", "Identifier"],
  ],
  BiologicallyDerivedProductDispense: [
    ["basedOn", "Reference"],
    ["destination", "Reference"],
    ["identifier", "Identifier"],
    ["location", "Reference"],
    ["matchStatus", "CodeableConcept"],
    ["note", "Annotation"],
    ["originRelationshipType", "CodeableConcept"],
    ["partOf", "Reference"],
    ["patient", "Reference"],
    ["performer", "BiologicallyDerivedProductDispensePerformer"],
    ["preparedDate", "dateTime"],
    ["product", "Reference"],
    ["quantity", "Quantity"],
    ["status", "code"],
    ["usageInstruction", "string"],
    ["whenHandedOver", "dateTime"],
  ],
  BiologicallyDerivedProductDispensePerformer: [
    ["actor", "Reference"],
    ["function", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  BodyStructure: [
    ["active", "boolean"],
    ["description", "markdown"],
    ["identifier", "Identifier"],
    ["morphology", "CodeableConcept"],
    ["patient", "Reference"],
  ],
  CanonicalResource: [
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  CapabilityStatement: [
    ["acceptLanguage", "code"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["document", "CapabilityStatementDocument"],
    ["experimental", "boolean"],
    ["fhirVersion", "code"],
    ["format", "code"],
    ["identifier", "Identifier"],
    ["implementation", "CapabilityStatementImplementation"],
    ["implementationGuide", "canonical"],
    ["imports", "canonical"],
    ["instantiates", "canonical"],
    ["jurisdiction", "CodeableConcept"],
    ["kind", "code"],
    ["messaging", "CapabilityStatementMessaging"],
    ["name", "string"],
    ["patchFormat", "code"],
    ["publisher", "string"],
    ["rest", "CapabilityStatementRest"],
    ["software", "CapabilityStatementSoftware"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  CapabilityStatementDocument: [
    ["mode", "code"],
    ["modifierExtension", "Extension"],
    ["profile", "canonical"],
  ],
  CapabilityStatementImplementation: [
    ["custodian", "Reference"],
    ["description", "markdown"],
    ["modifierExtension", "Extension"],
    ["url", "url"],
  ],
  CapabilityStatementMessaging: [
    ["modifierExtension", "Extension"],
    ["supportedMessage", "CapabilityStatementMessagingSupportedMessage"],
  ],
  CapabilityStatementMessagingSupportedMessage: [
    ["definition", "canonical"],
    ["mode", "code"],
    ["modifierExtension", "Extension"],
  ],
  CapabilityStatementRest: [
    ["mode", "code"],
    ["modifierExtension", "Extension"],
    ["resource", "CapabilityStatementRestResource"],
    ["security", "CapabilityStatementRestSecurity"],
  ],
  CapabilityStatementRestResource: [
    ["modifierExtension", "Extension"],
    ["operation", "CapabilityStatementRestResourceOperation"],
    ["profile", "canonical"],
    ["supportedProfile", "canonical"],
    ["type", "code"],
  ],
  CapabilityStatementRestResourceOperation: [
    ["definition", "canonical"],
    ["modifierExtension", "Extension"],
    ["name", "string"],
  ],
  CapabilityStatementRestSecurity: [
    ["cors", "boolean"],
    ["modifierExtension", "Extension"],
    ["service", "CodeableConcept"],
  ],
  CapabilityStatementSoftware: [
    ["modifierExtension", "Extension"],
    ["name", "string"],
    ["releaseDate", "dateTime"],
    ["version", "string"],
  ],
  CarePlan: [
    ["addresses", "CodeableReference"],
    ["basedOn", "Reference"],
    ["category", "CodeableConcept"],
    ["created", "dateTime"],
    ["custodian", "Reference"],
    ["description", "string"],
    ["encounter", "Reference"],
    ["identifier", "Identifier"],
    ["instantiatesCanonical", "canonical"],
    ["instantiatesUri", "uri"],
    ["intent", "code"],
    ["partOf", "Reference"],
    ["period", "Period"],
    ["replaces", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
    ["title", "string"],
  ],
  CareTeam: [
    ["category", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["managingOrganization", "Reference"],
    ["name", "string"],
    ["period", "Period"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  ChargeItem: [
    ["account", "Reference"],
    ["bodysite", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["encounter", "Reference"],
    ["enteredDate", "dateTime"],
    ["enterer", "Reference"],
    ["identifier", "Identifier"],
    ["occurrenceDateTime", "dateTime"],
    ["occurrencePeriod", "Period"],
    ["occurrenceTiming", "Timing"],
    ["quantity", "Quantity"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  ChargeItemDefinition: [
    ["code", "CodeableConcept"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["derivedFromUri", "uri"],
    ["description", "markdown"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["partOf", "canonical"],
    ["publisher", "string"],
    ["replaces", "canonical"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  Citation: [
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  Claim: [
    ["billablePeriod", "Period"],
    ["created", "dateTime"],
    ["insurance", "ClaimInsurance"],
    ["insurer", "Reference"],
    ["patient", "Reference"],
    ["priority", "CodeableConcept"],
    ["provider", "Reference"],
    ["status", "code"],
    ["type", "CodeableConcept"],
    ["use", "code"],
  ],
  ClaimInsurance: [
    ["coverage", "Reference"],
    ["focal", "boolean"],
    ["modifierExtension", "Extension"],
    ["sequence", "positiveInt"],
  ],
  ClaimResponse: [
    ["created", "dateTime"],
    ["decision", "CodeableConcept"],
    ["insurer", "Reference"],
    ["outcome", "code"],
    ["patient", "Reference"],
    ["request", "Reference"],
    ["status", "code"],
    ["total", "ClaimResponseTotal"],
    ["type", "CodeableConcept"],
    ["use", "code"],
  ],
  ClaimResponseTotal: [
    ["amount", "Money"],
    ["category", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  ClinicalImpression: [
    ["date", "dateTime"],
    ["description", "string"],
    ["effectiveDateTime", "dateTime"],
    ["effectivePeriod", "Period"],
    ["encounter", "Reference"],
    ["identifier", "Identifier"],
    ["performer", "Reference"],
    ["problem", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  ClinicalUseDefinition: [
    ["category", "CodeableConcept"],
    ["contraindication", "ClinicalUseDefinitionContraindication"],
    ["identifier", "Identifier"],
    ["indication", "ClinicalUseDefinitionIndication"],
    ["interaction", "ClinicalUseDefinitionInteraction"],
    ["library", "canonical"],
    ["population", "Reference"],
    ["status", "CodeableConcept"],
    ["subject", "Reference"],
    ["type", "code"],
    ["undesirableEffect", "ClinicalUseDefinitionUndesirableEffect"],
    ["warning", "ClinicalUseDefinitionWarning"],
  ],
  ClinicalUseDefinitionContraindication: [
    ["comorbidity", "CodeableReference"],
    ["diseaseStatus", "CodeableReference"],
    ["diseaseSymptomProcedure", "CodeableReference"],
    ["indication", "Reference"],
    ["modifierExtension", "Extension"],
    ["otherTherapy", "ClinicalUseDefinitionContraindicationOtherTherapy"],
  ],
  ClinicalUseDefinitionContraindicationOtherTherapy: [
    ["modifierExtension", "Extension"],
    ["relationshipType", "CodeableConcept"],
    ["treatment", "CodeableReference"],
  ],
  ClinicalUseDefinitionIndication: [
    ["comorbidity", "CodeableReference"],
    ["diseaseStatus", "CodeableReference"],
    ["diseaseSymptomProcedure", "CodeableReference"],
    ["durationRange", "Range"],
    ["durationString", "string"],
    ["intendedEffect", "CodeableReference"],
    ["modifierExtension", "Extension"],
    ["undesirableEffect", "Reference"],
  ],
  ClinicalUseDefinitionInteraction: [
    ["effect", "CodeableReference"],
    ["incidence", "CodeableConcept"],
    ["interactant", "ClinicalUseDefinitionInteractionInteractant"],
    ["management", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
  ],
  ClinicalUseDefinitionInteractionInteractant: [
    ["itemReference", "Reference"],
    ["itemCodeableConcept", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  ClinicalUseDefinitionUndesirableEffect: [
    ["classification", "CodeableConcept"],
    ["frequencyOfOccurrence", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["symptomConditionEffect", "CodeableReference"],
  ],
  ClinicalUseDefinitionWarning: [
    ["code", "CodeableConcept"],
    ["description", "markdown"],
    ["modifierExtension", "Extension"],
  ],
  CodeSystem: [
    ["caseSensitive", "boolean"],
    ["compositional", "boolean"],
    ["contact", "ContactDetail"],
    ["content", "code"],
    ["count", "unsignedInt"],
    ["date", "dateTime"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["filter", "CodeSystemFilter"],
    ["hierarchyMeaning", "code"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["property", "CodeSystemProperty"],
    ["publisher", "string"],
    ["status", "code"],
    ["supplements", "canonical"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["valueSet", "canonical"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
    ["versionNeeded", "boolean"],
  ],
  CodeSystemFilter: [
    ["code", "code"],
    ["description", "string"],
    ["modifierExtension", "Extension"],
    ["operator", "code"],
    ["value", "string"],
  ],
  CodeSystemProperty: [
    ["code", "code"],
    ["description", "string"],
    ["modifierExtension", "Extension"],
    ["type", "code"],
    ["uri", "uri"],
  ],
  Communication: [
    ["basedOn", "Reference"],
    ["encounter", "Reference"],
    ["identifier", "Identifier"],
    ["instantiatesCanonical", "canonical"],
    ["instantiatesUri", "uri"],
    ["partOf", "Reference"],
    ["priority", "code"],
    ["reason", "CodeableReference"],
    ["status", "code"],
    ["statusReason", "CodeableConcept"],
    ["subject", "Reference"],
  ],
  CommunicationRequest: [
    ["authoredOn", "dateTime"],
    ["basedOn", "Reference"],
    ["doNotPerform", "boolean"],
    ["encounter", "Reference"],
    ["groupIdentifier", "Identifier"],
    ["identifier", "Identifier"],
    ["informationProvider", "Reference"],
    ["intent", "code"],
    ["occurrenceDateTime", "dateTime"],
    ["occurrencePeriod", "Period"],
    ["priority", "code"],
    ["reason", "CodeableReference"],
    ["replaces", "Reference"],
    ["requester", "Reference"],
    ["status", "code"],
  ],
  CompartmentDefinition: [
    ["code", "code"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["experimental", "boolean"],
    ["name", "string"],
    ["publisher", "string"],
    ["resource", "CompartmentDefinitionResource"],
    ["search", "boolean"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  CompartmentDefinitionResource: [
    ["code", "code"],
    ["modifierExtension", "Extension"],
    ["param", "string"],
  ],
  Composition: [
    ["author", "Reference"],
    ["category", "CodeableConcept"],
    ["custodian", "Reference"],
    ["date", "dateTime"],
    ["encounter", "Reference"],
    ["event", "CompositionEvent"],
    ["identifier", "Identifier"],
    ["name", "string"],
    ["status", "code"],
    ["subject", "Reference"],
    ["title", "string"],
    ["type", "CodeableConcept"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
  ],
  CompositionEvent: [
    ["detail", "CodeableReference"],
    ["modifierExtension", "Extension"],
    ["period", "Period"],
  ],
  ConceptMap: [
    ["additionalAttribute", "ConceptMapAdditionalAttribute"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["property", "ConceptMapProperty"],
    ["publisher", "string"],
    ["sourceScopeUri", "uri"],
    ["sourceScopeCanonical", "canonical"],
    ["status", "code"],
    ["targetScopeUri", "uri"],
    ["targetScopeCanonical", "canonical"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  ConceptMapAdditionalAttribute: [
    ["code", "code"],
    ["description", "string"],
    ["modifierExtension", "Extension"],
    ["type", "code"],
    ["uri", "uri"],
  ],
  ConceptMapProperty: [
    ["code", "code"],
    ["description", "string"],
    ["modifierExtension", "Extension"],
    ["system", "canonical"],
    ["type", "code"],
    ["uri", "uri"],
  ],
  Condition: [
    ["bodySite", "CodeableConcept"],
    ["clinicalStatus", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["encounter", "Reference"],
    ["evidence", "CodeableReference"],
    ["identifier", "Identifier"],
    ["onsetDateTime", "dateTime"],
    ["onsetAge", "Age"],
    ["onsetPeriod", "Period"],
    ["onsetRange", "Range"],
    ["onsetString", "string"],
    ["participant", "ConditionParticipant"],
    ["recordedDate", "dateTime"],
    ["subject", "Reference"],
    ["verificationStatus", "CodeableConcept"],
  ],
  ConditionParticipant: [
    ["actor", "Reference"],
    ["function", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  ConditionDefinition: [
    ["bodySite", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["severity", "CodeableConcept"],
    ["stage", "CodeableConcept"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  Consent: [
    ["category", "CodeableConcept"],
    ["date", "date"],
    ["decision", "code"],
    ["grantee", "Reference"],
    ["grantor", "Reference"],
    ["identifier", "Identifier"],
    ["period", "Period"],
    ["provision", "ConsentProvision"],
    ["status", "code"],
    ["subject", "Reference"],
    ["verification", "ConsentVerification"],
  ],
  ConsentProvision: [
    ["action", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["data", "ConsentProvisionData"],
    ["dataPeriod", "Period"],
    ["documentType", "Coding"],
    ["modifierExtension", "Extension"],
    ["period", "Period"],
    ["purpose", "Coding"],
    ["resourceType", "Coding"],
    ["securityLabel", "Coding"],
  ],
  ConsentProvisionData: [
    ["meaning", "code"],
    ["modifierExtension", "Extension"],
    ["reference", "Reference"],
  ],
  ConsentVerification: [
    ["modifierExtension", "Extension"],
    ["verified", "boolean"],
  ],
  Contract: [
    ["applies", "Period"],
    ["identifier", "Identifier"],
    ["issued", "dateTime"],
    ["name", "string"],
    ["status", "code"],
    ["subject", "Reference"],
    ["subType", "CodeableConcept"],
    ["title", "string"],
    ["type", "CodeableConcept"],
    ["version", "string"],
  ],
  Coverage: [
    ["beneficiary", "Reference"],
    ["dependent", "string"],
    ["identifier", "Identifier"],
    ["insurer", "Reference"],
    ["kind", "code"],
    ["network", "string"],
    ["order", "positiveInt"],
    ["period", "Period"],
    ["policyHolder", "Reference"],
    ["status", "code"],
    ["subscriber", "Reference"],
    ["subscriberId", "Identifier"],
    ["type", "CodeableConcept"],
  ],
  CoverageEligibilityRequest: [
    ["created", "dateTime"],
    ["insurer", "Reference"],
    ["patient", "Reference"],
    ["purpose", "code"],
    ["status", "code"],
  ],
  CoverageEligibilityResponse: [
    ["created", "dateTime"],
    ["insurer", "Reference"],
    ["outcome", "code"],
    ["patient", "Reference"],
    ["purpose", "code"],
    ["request", "Reference"],
    ["status", "code"],
  ],
  DetectedIssue: [
    ["author", "Reference"],
    ["code", "CodeableConcept"],
    ["encounter", "Reference"],
    ["identifiedDateTime", "dateTime"],
    ["identifiedPeriod", "Period"],
    ["identifier", "Identifier"],
    ["implicated", "Reference"],
    ["severity", "code"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  Device: [
    ["safety", "CodeableConcept"],
    ["status", "code"],
    ["udiCarrier", "DeviceUdiCarrier"],
  ],
  DeviceUdiCarrier: [
    ["carrierAIDC", "base64Binary"],
    ["carrierHRF", "string"],
    ["deviceIdentifier", "string"],
    ["issuer", "uri"],
    ["modifierExtension", "Extension"],
  ],
  DeviceAssociation: [
    ["bodyStructure", "Reference"],
    ["category", "CodeableConcept"],
    ["device", "Reference"],
    ["identifier", "Identifier"],
    ["operation", "DeviceAssociationOperation"],
    ["period", "Period"],
    ["status", "CodeableConcept"],
    ["statusReason", "CodeableConcept"],
    ["subject", "Reference"],
  ],
  DeviceAssociationOperation: [
    ["modifierExtension", "Extension"],
    ["operator", "Reference"],
    ["period", "Period"],
    ["status", "CodeableConcept"],
  ],
  DeviceDefinition: [
    ["classification", "DeviceDefinitionClassification"],
    ["conformsTo", "DeviceDefinitionConformsTo"],
    ["deviceName", "DeviceDefinitionDeviceName"],
    ["hasPart", "DeviceDefinitionHasPart"],
    ["identifier", "Identifier"],
    ["manufacturer", "Reference"],
    ["modelNumber", "string"],
    ["safety", "CodeableConcept"],
  ],
  DeviceDefinitionClassification: [
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
  ],
  DeviceDefinitionConformsTo: [
    ["category", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["specification", "CodeableConcept"],
    ["version", "string"],
  ],
  DeviceDefinitionDeviceName: [
    ["modifierExtension", "Extension"],
    ["name", "string"],
    ["type", "code"],
  ],
  DeviceDefinitionHasPart: [
    ["modifierExtension", "Extension"],
    ["reference", "Reference"],
  ],
  DeviceDispense: [
    ["device", "CodeableReference"],
    ["identifier", "Identifier"],
    ["preparedDate", "dateTime"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  DeviceMetric: [
    ["category", "code"],
    ["device", "Reference"],
    ["identifier", "Identifier"],
    ["operationalStatus", "code"],
    ["type", "CodeableConcept"],
    ["unit", "CodeableConcept"],
  ],
  DeviceRequest: [
    ["authoredOn", "dateTime"],
    ["basedOn", "Reference"],
    ["code", "CodeableReference"],
    ["doNotPerform", "boolean"],
    ["encounter", "Reference"],
    ["groupIdentifier", "Identifier"],
    ["identifier", "Identifier"],
    ["instantiatesCanonical", "canonical"],
    ["instantiatesUri", "uri"],
    ["intent", "code"],
    ["occurrenceDateTime", "dateTime"],
    ["occurrencePeriod", "Period"],
    ["occurrenceTiming", "Timing"],
    ["performer", "CodeableReference"],
    ["priority", "code"],
    ["reason", "CodeableReference"],
    ["replaces", "Reference"],
    ["requester", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  DeviceUsage: [
    ["basedOn", "Reference"],
    ["bodySite", "CodeableReference"],
    ["context", "Reference"],
    ["dateAsserted", "dateTime"],
    ["derivedFrom", "Reference"],
    ["device", "CodeableReference"],
    ["identifier", "Identifier"],
    ["informationSource", "Reference"],
    ["patient", "Reference"],
    ["reason", "CodeableReference"],
    ["status", "code"],
    ["timingTiming", "Timing"],
    ["timingPeriod", "Period"],
    ["timingDateTime", "dateTime"],
  ],
  DiagnosticReport: [
    ["category", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["effectiveDateTime", "dateTime"],
    ["effectivePeriod", "Period"],
    ["encounter", "Reference"],
    ["identifier", "Identifier"],
    ["issued", "instant"],
    ["media", "DiagnosticReportMedia"],
    ["performer", "Reference"],
    ["resultsInterpreter", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  DiagnosticReportMedia: [
    ["link", "Reference"],
    ["modifierExtension", "Extension"],
  ],
  DocumentReference: [
    ["author", "Reference"],
    ["bodySite", "CodeableReference"],
    ["category", "CodeableConcept"],
    ["content", "DocumentReferenceContent"],
    ["date", "instant"],
    ["description", "markdown"],
    ["docStatus", "code"],
    ["identifier", "Identifier"],
    ["modality", "CodeableConcept"],
    ["period", "Period"],
    ["relatesTo", "DocumentReferenceRelatesTo"],
    ["securityLabel", "CodeableConcept"],
    ["status", "code"],
    ["subject", "Reference"],
    ["type", "CodeableConcept"],
    ["version", "string"],
  ],
  DocumentReferenceContent: [
    ["attachment", "Attachment"],
    ["modifierExtension", "Extension"],
    ["profile", "DocumentReferenceContentProfile"],
  ],
  DocumentReferenceContentProfile: [
    ["modifierExtension", "Extension"],
    ["valueCoding", "Coding"],
    ["valueUri", "uri"],
    ["valueCanonical", "canonical"],
  ],
  DocumentReferenceRelatesTo: [
    ["code", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["target", "Reference"],
  ],
  Encounter: [
    ["appointment", "Reference"],
    ["class", "CodeableConcept"],
    ["diagnosis", "EncounterDiagnosis"],
    ["episodeOfCare", "Reference"],
    ["identifier", "Identifier"],
    ["participant", "EncounterParticipant"],
    ["reason", "EncounterReason"],
    ["serviceType", "CodeableReference"],
    ["status", "code"],
    ["subject", "Reference"],
    ["type", "CodeableConcept"],
  ],
  EncounterDiagnosis: [
    ["condition", "CodeableReference"],
    ["modifierExtension", "Extension"],
  ],
  EncounterParticipant: [
    ["actor", "Reference"],
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
  ],
  EncounterReason: [
    ["modifierExtension", "Extension"],
    ["use", "CodeableConcept"],
    ["value", "CodeableReference"],
  ],
  EncounterHistory: [
    ["class", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["serviceType", "CodeableReference"],
    ["status", "code"],
    ["subject", "Reference"],
    ["type", "CodeableConcept"],
  ],
  Endpoint: [
    ["address", "url"],
    ["connectionType", "CodeableConcept"],
    ["description", "string"],
    ["environmentType", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["managingOrganization", "Reference"],
    ["name", "string"],
    ["period", "Period"],
    ["status", "code"],
  ],
  EnrollmentRequest: [["status", "code"]],
  EnrollmentResponse: [["status", "code"]],
  EpisodeOfCare: [
    ["diagnosis", "EpisodeOfCareDiagnosis"],
    ["managingOrganization", "Reference"],
    ["patient", "Reference"],
    ["period", "Period"],
    ["reason", "EpisodeOfCareReason"],
    ["status", "code"],
    ["type", "CodeableConcept"],
  ],
  EpisodeOfCareDiagnosis: [
    ["condition", "CodeableReference"],
    ["modifierExtension", "Extension"],
    ["use", "CodeableConcept"],
  ],
  EpisodeOfCareReason: [
    ["modifierExtension", "Extension"],
    ["use", "CodeableConcept"],
    ["value", "CodeableReference"],
  ],
  EventDefinition: [
    ["approvalDate", "date"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["lastReviewDate", "date"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["trigger", "TriggerDefinition"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  Evidence: [
    ["author", "ContactDetail"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["endorser", "ContactDetail"],
    ["identifier", "Identifier"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  EvidenceReport: [
    ["author", "ContactDetail"],
    ["contact", "ContactDetail"],
    ["endorser", "ContactDetail"],
    ["identifier", "Identifier"],
    ["publisher", "string"],
    ["relatedIdentifier", "Identifier"],
    ["status", "code"],
    ["subject", "EvidenceReportSubject"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
  ],
  EvidenceReportSubject: [["modifierExtension", "Extension"]],
  EvidenceVariable: [
    ["characteristic", "EvidenceVariableCharacteristic"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["description", "markdown"],
    ["identifier", "Identifier"],
    ["name", "string"],
    ["publisher", "string"],
    ["shortTitle", "string"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  EvidenceVariableCharacteristic: [
    [
      "definitionByTypeAndValue",
      "EvidenceVariableCharacteristicDefinitionByTypeAndValue",
    ],
    ["definitionCanonical", "canonical"],
    ["definitionCodeableConcept", "CodeableConcept"],
    ["definitionExpression", "Expression"],
    ["definitionId", "id"],
    ["definitionReference", "Reference"],
    ["modifierExtension", "Extension"],
  ],
  EvidenceVariableCharacteristicDefinitionByTypeAndValue: [
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
    ["valueCodeableConcept", "CodeableConcept"],
    ["valueBoolean", "boolean"],
    ["valueQuantity", "Quantity"],
    ["valueRange", "Range"],
    ["valueReference", "Reference"],
    ["valueId", "id"],
  ],
  ExampleScenario: [
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["description", "markdown"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  ExplanationOfBenefit: [
    ["billablePeriod", "Period"],
    ["created", "dateTime"],
    ["decision", "CodeableConcept"],
    ["insurance", "ExplanationOfBenefitInsurance"],
    ["insurer", "Reference"],
    ["outcome", "code"],
    ["patient", "Reference"],
    ["provider", "Reference"],
    ["status", "code"],
    ["total", "ExplanationOfBenefitTotal"],
    ["type", "CodeableConcept"],
    ["use", "code"],
  ],
  ExplanationOfBenefitInsurance: [
    ["coverage", "Reference"],
    ["focal", "boolean"],
    ["modifierExtension", "Extension"],
  ],
  ExplanationOfBenefitTotal: [
    ["amount", "Money"],
    ["category", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  FamilyMemberHistory: [
    ["ageAge", "Age"],
    ["ageRange", "Range"],
    ["ageString", "string"],
    ["dataAbsentReason", "CodeableConcept"],
    ["date", "dateTime"],
    ["deceasedBoolean", "boolean"],
    ["deceasedAge", "Age"],
    ["deceasedRange", "Range"],
    ["deceasedDate", "date"],
    ["deceasedString", "string"],
    ["estimatedAge", "boolean"],
    ["identifier", "Identifier"],
    ["instantiatesCanonical", "canonical"],
    ["instantiatesUri", "uri"],
    ["name", "string"],
    ["participant", "FamilyMemberHistoryParticipant"],
    ["patient", "Reference"],
    ["reason", "CodeableReference"],
    ["relationship", "CodeableConcept"],
    ["sex", "CodeableConcept"],
    ["status", "code"],
  ],
  FamilyMemberHistoryParticipant: [
    ["actor", "Reference"],
    ["function", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  Flag: [
    ["author", "Reference"],
    ["category", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["encounter", "Reference"],
    ["identifier", "Identifier"],
    ["period", "Period"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  FormularyItem: [
    ["code", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["status", "code"],
  ],
  GenomicStudy: [
    ["encounter", "Reference"],
    ["identifier", "Identifier"],
    ["status", "code"],
    ["subject", "Reference"],
    ["type", "CodeableConcept"],
  ],
  Goal: [
    ["achievementStatus", "CodeableConcept"],
    ["category", "CodeableConcept"],
    ["description", "CodeableConcept"],
    ["lifecycleStatus", "code"],
    ["priority", "CodeableConcept"],
    ["source", "Reference"],
    ["startDate", "date"],
    ["startCodeableConcept", "CodeableConcept"],
    ["statusDate", "date"],
    ["subject", "Reference"],
  ],
  GraphDefinition: [
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  Group: [
    ["active", "boolean"],
    ["characteristic", "GroupCharacteristic"],
    ["code", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["managingEntity", "Reference"],
    ["membership", "code"],
    ["name", "string"],
    ["quantity", "unsignedInt"],
    ["type", "code"],
  ],
  GroupCharacteristic: [
    ["code", "CodeableConcept"],
    ["exclude", "boolean"],
    ["modifierExtension", "Extension"],
    ["valueCodeableConcept", "CodeableConcept"],
    ["valueBoolean", "boolean"],
    ["valueQuantity", "Quantity"],
    ["valueRange", "Range"],
    ["valueReference", "Reference"],
  ],
  GuidanceResponse: [
    ["identifier", "Identifier"],
    ["moduleUri", "uri"],
    ["moduleCanonical", "canonical"],
    ["moduleCodeableConcept", "CodeableConcept"],
    ["requestIdentifier", "Identifier"],
    ["status", "code"],
  ],
  HealthcareService: [
    ["active", "boolean"],
    ["category", "CodeableConcept"],
    ["comment", "markdown"],
    ["identifier", "Identifier"],
    ["location", "Reference"],
    ["name", "string"],
    ["photo", "Attachment"],
    ["providedBy", "Reference"],
    ["specialty", "CodeableConcept"],
    ["type", "CodeableConcept"],
  ],
  ImagingSelection: [
    ["basedOn", "Reference"],
    ["bodySite", "CodeableReference"],
    ["category", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["derivedFrom", "Reference"],
    ["endpoint", "Reference"],
    ["focus", "Reference"],
    ["frameOfReferenceUid", "id"],
    ["identifier", "Identifier"],
    ["instance", "ImagingSelectionInstance"],
    ["issued", "instant"],
    ["performer", "ImagingSelectionPerformer"],
    ["seriesNumber", "unsignedInt"],
    ["seriesUid", "id"],
    ["status", "code"],
    ["studyUid", "id"],
    ["subject", "Reference"],
  ],
  ImagingSelectionInstance: [
    ["modifierExtension", "Extension"],
    ["number", "unsignedInt"],
    ["uid", "id"],
  ],
  ImagingSelectionPerformer: [
    ["actor", "Reference"],
    ["function", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  ImagingStudy: [
    ["basedOn", "Reference"],
    ["description", "string"],
    ["encounter", "Reference"],
    ["endpoint", "Reference"],
    ["identifier", "Identifier"],
    ["location", "Reference"],
    ["modality", "CodeableConcept"],
    ["note", "Annotation"],
    ["numberOfInstances", "unsignedInt"],
    ["numberOfSeries", "unsignedInt"],
    ["partOf", "Reference"],
    ["procedure", "CodeableReference"],
    ["reason", "CodeableReference"],
    ["referrer", "Reference"],
    ["series", "ImagingStudySeries"],
    ["started", "dateTime"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  ImagingStudySeries: [
    ["bodySite", "CodeableReference"],
    ["description", "string"],
    ["endpoint", "Reference"],
    ["laterality", "CodeableConcept"],
    ["modality", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["number", "unsignedInt"],
    ["numberOfInstances", "unsignedInt"],
    ["performer", "ImagingStudySeriesPerformer"],
    ["specimen", "Reference"],
    ["started", "dateTime"],
    ["uid", "id"],
  ],
  ImagingStudySeriesPerformer: [
    ["actor", "Reference"],
    ["function", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  Immunization: [
    ["basedOn", "Reference"],
    ["isSubpotent", "boolean"],
    ["note", "Annotation"],
    ["occurrenceDateTime", "dateTime"],
    ["occurrenceString", "string"],
    ["patient", "Reference"],
    ["performer", "ImmunizationPerformer"],
    ["primarySource", "boolean"],
    ["status", "code"],
    ["vaccineCode", "CodeableConcept"],
  ],
  ImmunizationPerformer: [
    ["actor", "Reference"],
    ["function", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  ImmunizationEvaluation: [
    ["doseStatus", "CodeableConcept"],
    ["immunizationEvent", "Reference"],
    ["patient", "Reference"],
    ["status", "code"],
    ["targetDisease", "CodeableConcept"],
  ],
  ImmunizationRecommendation: [
    ["date", "dateTime"],
    ["identifier", "Identifier"],
    ["patient", "Reference"],
    ["recommendation", "ImmunizationRecommendationRecommendation"],
  ],
  ImmunizationRecommendationRecommendation: [
    ["contraindicatedVaccineCode", "CodeableConcept"],
    ["doseNumber", "string"],
    ["forecastReason", "CodeableConcept"],
    ["forecastStatus", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["targetDisease", "CodeableConcept"],
    ["vaccineCode", "CodeableConcept"],
  ],
  ImplementationGuide: [
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["dependsOn", "ImplementationGuideDependsOn"],
    ["experimental", "boolean"],
    ["fhirVersion", "code"],
    ["global", "ImplementationGuideGlobal"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["license", "code"],
    ["name", "string"],
    ["packageId", "id"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  ImplementationGuideDependsOn: [
    ["modifierExtension", "Extension"],
    ["packageId", "id"],
    ["uri", "canonical"],
    ["version", "string"],
  ],
  ImplementationGuideGlobal: [
    ["modifierExtension", "Extension"],
    ["profile", "canonical"],
    ["type", "code"],
  ],
  ImplementationGuideManifestResource: [
    ["modifierExtension", "Extension"],
    ["reference", "Reference"],
  ],
  Ingredient: [
    ["allergenicIndicator", "boolean"],
    ["for", "Reference"],
    ["function", "CodeableConcept"],
    ["group", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["manufacturer", "IngredientManufacturer"],
    ["role", "CodeableConcept"],
    ["status", "code"],
    ["substance", "IngredientSubstance"],
  ],
  IngredientManufacturer: [
    ["manufacturer", "Reference"],
    ["modifierExtension", "Extension"],
    ["role", "code"],
  ],
  IngredientSubstance: [
    ["code", "CodeableReference"],
    ["modifierExtension", "Extension"],
    ["strength", "IngredientSubstanceStrength"],
  ],
  IngredientSubstanceStrength: [
    ["basis", "CodeableConcept"],
    ["concentrationRatio", "Ratio"],
    ["concentrationRatioRange", "RatioRange"],
    ["concentrationCodeableConcept", "CodeableConcept"],
    ["concentrationQuantity", "Quantity"],
    ["country", "CodeableConcept"],
    ["measurementPoint", "string"],
    ["modifierExtension", "Extension"],
    ["presentationRatio", "Ratio"],
    ["presentationRatioRange", "RatioRange"],
    ["presentationCodeableConcept", "CodeableConcept"],
    ["presentationQuantity", "Quantity"],
    ["referenceStrength", "IngredientSubstanceStrengthReferenceStrength"],
    ["textConcentration", "string"],
    ["textPresentation", "string"],
  ],
  IngredientSubstanceStrengthReferenceStrength: [
    ["country", "CodeableConcept"],
    ["measurementPoint", "string"],
    ["modifierExtension", "Extension"],
    ["strengthRatio", "Ratio"],
    ["strengthRatioRange", "RatioRange"],
    ["strengthQuantity", "Quantity"],
    ["substance", "CodeableReference"],
  ],
  InsurancePlan: [
    ["administeredBy", "Reference"],
    ["coverageArea", "Reference"],
    ["identifier", "Identifier"],
    ["name", "string"],
    ["ownedBy", "Reference"],
    ["status", "code"],
    ["type", "CodeableConcept"],
  ],
  InventoryItem: [
    ["baseUnit", "CodeableConcept"],
    ["category", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["inventoryStatus", "CodeableConcept"],
    ["name", "InventoryItemName"],
    ["netContent", "Quantity"],
    ["status", "code"],
  ],
  InventoryItemName: [
    ["language", "code"],
    ["modifierExtension", "Extension"],
    ["name", "string"],
    ["nameType", "Coding"],
  ],
  InventoryReport: [
    ["countType", "code"],
    ["identifier", "Identifier"],
    ["inventoryListing", "InventoryReportInventoryListing"],
    ["operationType", "CodeableConcept"],
    ["operationTypeReason", "CodeableConcept"],
    ["reportedDateTime", "dateTime"],
    ["status", "code"],
  ],
  InventoryReportInventoryListing: [
    ["item", "InventoryReportInventoryListingItem"],
    ["itemStatus", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  InventoryReportInventoryListingItem: [
    ["category", "CodeableConcept"],
    ["item", "CodeableReference"],
    ["modifierExtension", "Extension"],
    ["quantity", "Quantity"],
  ],
  Invoice: [
    ["creation", "dateTime"],
    ["identifier", "Identifier"],
    ["periodDate", "date"],
    ["periodPeriod", "Period"],
    ["recipient", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
    ["totalGross", "Money"],
    ["totalNet", "Money"],
    ["type", "CodeableConcept"],
  ],
  Library: [
    ["contact", "ContactDetail"],
    ["content", "Attachment"],
    ["date", "dateTime"],
    ["description", "markdown"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["type", "CodeableConcept"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  Linkage: [
    ["active", "boolean"],
    ["author", "Reference"],
    ["item", "LinkageItem"],
  ],
  LinkageItem: [
    ["modifierExtension", "Extension"],
    ["resource", "Reference"],
    ["type", "code"],
  ],
  List: [
    ["code", "CodeableConcept"],
    ["date", "dateTime"],
    ["mode", "code"],
    ["source", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
    ["title", "string"],
  ],
  Location: [
    ["description", "markdown"],
    ["form", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["managingOrganization", "Reference"],
    ["mode", "code"],
    ["name", "string"],
    ["operationalStatus", "Coding"],
    ["status", "code"],
    ["type", "CodeableConcept"],
  ],
  ManufacturedItemDefinition: [
    ["component", "ManufacturedItemDefinitionComponent"],
    ["identifier", "Identifier"],
    ["ingredient", "CodeableConcept"],
    ["manufacturedDoseForm", "CodeableConcept"],
    ["manufacturer", "Reference"],
    ["marketingStatus", "MarketingStatus"],
    ["name", "string"],
    ["property", "ManufacturedItemDefinitionProperty"],
    ["status", "code"],
    ["unitOfPresentation", "CodeableConcept"],
  ],
  ManufacturedItemDefinitionComponent: [
    ["amount", "Quantity"],
    ["constituent", "ManufacturedItemDefinitionComponentConstituent"],
    ["function", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
  ],
  ManufacturedItemDefinitionComponentConstituent: [
    ["amount", "Quantity"],
    ["function", "CodeableConcept"],
    ["hasIngredient", "CodeableReference"],
    ["location", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  ManufacturedItemDefinitionProperty: [
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
    ["valueCodeableConcept", "CodeableConcept"],
    ["valueQuantity", "Quantity"],
    ["valueDate", "date"],
    ["valueBoolean", "boolean"],
    ["valueMarkdown", "markdown"],
    ["valueAttachment", "Attachment"],
    ["valueReference", "Reference"],
  ],
  Measure: [
    ["basis", "code"],
    ["clinicalRecommendationStatement", "markdown"],
    ["compositeScoring", "CodeableConcept"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["description", "markdown"],
    ["disclaimer", "markdown"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["guidance", "markdown"],
    ["identifier", "Identifier"],
    ["improvementNotation", "CodeableConcept"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["rateAggregation", "markdown"],
    ["rationale", "markdown"],
    ["riskAdjustment", "markdown"],
    ["scoring", "CodeableConcept"],
    ["scoringUnit", "CodeableConcept"],
    ["status", "code"],
    ["title", "string"],
    ["type", "CodeableConcept"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  MeasureReport: [
    ["dataUpdateType", "code"],
    ["date", "dateTime"],
    ["identifier", "Identifier"],
    ["improvementNotation", "CodeableConcept"],
    ["measure", "canonical"],
    ["period", "Period"],
    ["reporter", "Reference"],
    ["scoring", "CodeableConcept"],
    ["status", "code"],
    ["subject", "Reference"],
    ["type", "code"],
  ],
  Medication: [
    ["code", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["marketingAuthorizationHolder", "Reference"],
    ["status", "code"],
    ["totalVolume", "Quantity"],
  ],
  MedicationAdministration: [
    ["medication", "CodeableReference"],
    ["occurenceDateTime", "dateTime"],
    ["occurencePeriod", "Period"],
    ["occurenceTiming", "Timing"],
    ["partOf", "Reference"],
    ["performer", "MedicationAdministrationPerformer"],
    ["recorded", "dateTime"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  MedicationAdministrationPerformer: [
    ["actor", "CodeableReference"],
    ["modifierExtension", "Extension"],
  ],
  MedicationDispense: [
    ["medication", "CodeableReference"],
    ["status", "code"],
    ["subject", "Reference"],
    ["whenPrepared", "dateTime"],
  ],
  MedicationKnowledge: [
    ["code", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["monitoringProgram", "MedicationKnowledgeMonitoringProgram"],
    ["name", "string"],
    ["status", "code"],
  ],
  MedicationKnowledgeDefinitionalIngredient: [
    ["item", "CodeableReference"],
    ["modifierExtension", "Extension"],
  ],
  MedicationKnowledgeMonitoringProgram: [["modifierExtension", "Extension"]],
  MedicationRequest: [
    ["authoredOn", "dateTime"],
    ["basedOn", "Reference"],
    ["doNotPerform", "boolean"],
    ["groupIdentifier", "Identifier"],
    ["intent", "code"],
    ["medication", "CodeableReference"],
    ["performerType", "CodeableConcept"],
    ["priority", "code"],
    ["reported", "boolean"],
    ["requester", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  MedicationStatement: [
    ["adherence", "MedicationStatementAdherence"],
    ["category", "CodeableConcept"],
    ["dateAsserted", "dateTime"],
    ["effectiveDateTime", "dateTime"],
    ["effectivePeriod", "Period"],
    ["effectiveTiming", "Timing"],
    ["encounter", "Reference"],
    ["identifier", "Identifier"],
    ["medication", "CodeableReference"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  MedicationStatementAdherence: [
    ["code", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  MedicinalProductDefinition: [
    ["additionalMonitoringIndicator", "CodeableConcept"],
    ["attachedDocument", "Reference"],
    ["characteristic", "MedicinalProductDefinitionCharacteristic"],
    ["classification", "CodeableConcept"],
    ["clinicalTrial", "Reference"],
    ["code", "Coding"],
    ["combinedPharmaceuticalDoseForm", "CodeableConcept"],
    ["comprisedOf", "Reference"],
    ["contact", "MedicinalProductDefinitionContact"],
    ["crossReference", "MedicinalProductDefinitionCrossReference"],
    ["description", "markdown"],
    ["domain", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["impurity", "CodeableReference"],
    ["indication", "markdown"],
    ["ingredient", "CodeableConcept"],
    ["legalStatusOfSupply", "CodeableConcept"],
    ["marketingStatus", "MarketingStatus"],
    ["masterFile", "Reference"],
    ["name", "MedicinalProductDefinitionName"],
    ["operation", "MedicinalProductDefinitionOperation"],
    ["packagedMedicinalProduct", "CodeableConcept"],
    ["pediatricUseIndicator", "CodeableConcept"],
    ["route", "CodeableConcept"],
    ["specialMeasures", "CodeableConcept"],
    ["status", "CodeableConcept"],
    ["statusDate", "dateTime"],
    ["type", "CodeableConcept"],
    ["version", "string"],
  ],
  MedicinalProductDefinitionCharacteristic: [
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
    ["valueCodeableConcept", "CodeableConcept"],
    ["valueMarkdown", "markdown"],
    ["valueQuantity", "Quantity"],
    ["valueInteger", "integer"],
    ["valueDate", "date"],
    ["valueBoolean", "boolean"],
    ["valueAttachment", "Attachment"],
  ],
  MedicinalProductDefinitionContact: [
    ["contact", "Reference"],
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
  ],
  MedicinalProductDefinitionCrossReference: [
    ["modifierExtension", "Extension"],
    ["product", "CodeableReference"],
    ["type", "CodeableConcept"],
  ],
  MedicinalProductDefinitionName: [
    ["modifierExtension", "Extension"],
    ["part", "MedicinalProductDefinitionNamePart"],
    ["productName", "string"],
    ["type", "CodeableConcept"],
    ["usage", "MedicinalProductDefinitionNameUsage"],
  ],
  MedicinalProductDefinitionNamePart: [
    ["modifierExtension", "Extension"],
    ["part", "string"],
    ["type", "CodeableConcept"],
  ],
  MedicinalProductDefinitionNameUsage: [
    ["country", "CodeableConcept"],
    ["jurisdiction", "CodeableConcept"],
    ["language", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  MedicinalProductDefinitionOperation: [
    ["confidentialityIndicator", "CodeableConcept"],
    ["effectiveDate", "Period"],
    ["modifierExtension", "Extension"],
    ["organization", "Reference"],
    ["type", "CodeableReference"],
  ],
  MessageDefinition: [
    ["base", "canonical"],
    ["category", "code"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["description", "markdown"],
    ["eventCoding", "Coding"],
    ["eventUri", "uri"],
    ["experimental", "boolean"],
    ["focus", "MessageDefinitionFocus"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["parent", "canonical"],
    ["publisher", "string"],
    ["purpose", "markdown"],
    ["replaces", "canonical"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  MessageDefinitionFocus: [
    ["code", "code"],
    ["min", "unsignedInt"],
    ["modifierExtension", "Extension"],
  ],
  MessageHeader: [
    ["author", "Reference"],
    ["definition", "canonical"],
    ["destination", "MessageHeaderDestination"],
    ["eventCoding", "Coding"],
    ["eventCanonical", "canonical"],
    ["focus", "Reference"],
    ["reason", "CodeableConcept"],
    ["response", "MessageHeaderResponse"],
    ["responsible", "Reference"],
    ["sender", "Reference"],
    ["source", "MessageHeaderSource"],
  ],
  MessageHeaderDestination: [
    ["endpointUrl", "url"],
    ["endpointReference", "Reference"],
    ["modifierExtension", "Extension"],
    ["name", "string"],
    ["receiver", "Reference"],
    ["target", "Reference"],
  ],
  MessageHeaderResponse: [
    ["code", "code"],
    ["details", "Reference"],
    ["identifier", "Identifier"],
    ["modifierExtension", "Extension"],
  ],
  MessageHeaderSource: [
    ["contact", "ContactPoint"],
    ["endpointUrl", "url"],
    ["endpointReference", "Reference"],
    ["modifierExtension", "Extension"],
    ["name", "string"],
    ["software", "string"],
    ["version", "string"],
  ],
  MetadataResource: [["effectivePeriod", "Period"]],
  MolecularSequence: [
    ["device", "Reference"],
    ["focus", "Reference"],
    ["formatted", "Attachment"],
    ["identifier", "Identifier"],
    ["literal", "string"],
    ["performer", "Reference"],
    ["relative", "MolecularSequenceRelative"],
    ["specimen", "Reference"],
    ["subject", "Reference"],
    ["type", "code"],
  ],
  MolecularSequenceRelative: [
    ["coordinateSystem", "CodeableConcept"],
    ["edit", "MolecularSequenceRelativeEdit"],
    ["modifierExtension", "Extension"],
    ["startingSequence", "MolecularSequenceRelativeStartingSequence"],
  ],
  MolecularSequenceRelativeEdit: [
    ["end", "integer"],
    ["modifierExtension", "Extension"],
    ["replacedSequence", "string"],
    ["replacementSequence", "string"],
    ["start", "integer"],
  ],
  MolecularSequenceRelativeStartingSequence: [
    ["chromosome", "CodeableConcept"],
    ["genomeAssembly", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["orientation", "code"],
    ["sequenceCodeableConcept", "CodeableConcept"],
    ["sequenceString", "string"],
    ["sequenceReference", "Reference"],
    ["strand", "code"],
    ["windowEnd", "integer"],
    ["windowStart", "integer"],
  ],
  NamingSystem: [
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["kind", "code"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["uniqueId", "NamingSystemUniqueId"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  NamingSystemUniqueId: [
    ["modifierExtension", "Extension"],
    ["type", "code"],
    ["value", "string"],
  ],
  NutritionIntake: [
    ["basedOn", "Reference"],
    ["code", "CodeableConcept"],
    ["encounter", "Reference"],
    ["identifier", "Identifier"],
    ["occurrenceDateTime", "dateTime"],
    ["occurrencePeriod", "Period"],
    ["partOf", "Reference"],
    ["recorded", "dateTime"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  NutritionOrder: [
    ["dateTime", "dateTime"],
    ["groupIdentifier", "Identifier"],
    ["instantiatesCanonical", "canonical"],
    ["instantiatesUri", "uri"],
    ["intent", "code"],
    ["orderer", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  NutritionProduct: [
    ["category", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["manufacturer", "Reference"],
    ["nutrient", "NutritionProductNutrient"],
    ["status", "code"],
  ],
  NutritionProductNutrient: [["modifierExtension", "Extension"]],
  Observation: [
    ["basedOn", "Reference"],
    ["code", "CodeableConcept"],
    ["component", "ObservationComponent"],
    ["derivedFrom", "Reference"],
    ["effectiveDateTime", "dateTime"],
    ["effectivePeriod", "Period"],
    ["effectiveTiming", "Timing"],
    ["effectiveInstant", "instant"],
    ["encounter", "Reference"],
    ["focus", "Reference"],
    ["hasMember", "Reference"],
    ["identifier", "Identifier"],
    ["instantiatesCanonical", "canonical"],
    ["instantiatesReference", "Reference"],
    ["issued", "instant"],
    ["partOf", "Reference"],
    ["performer", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
    ["valueQuantity", "Quantity"],
    ["valueCodeableConcept", "CodeableConcept"],
    ["valueString", "string"],
    ["valueBoolean", "boolean"],
    ["valueInteger", "integer"],
    ["valueRange", "Range"],
    ["valueRatio", "Ratio"],
    ["valueSampledData", "SampledData"],
    ["valueTime", "time"],
    ["valueDateTime", "dateTime"],
    ["valuePeriod", "Period"],
    ["valueAttachment", "Attachment"],
    ["valueReference", "Reference"],
  ],
  ObservationComponent: [
    ["code", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["valueQuantity", "Quantity"],
    ["valueCodeableConcept", "CodeableConcept"],
    ["valueString", "string"],
    ["valueBoolean", "boolean"],
    ["valueInteger", "integer"],
    ["valueRange", "Range"],
    ["valueRatio", "Ratio"],
    ["valueSampledData", "SampledData"],
    ["valueTime", "time"],
    ["valueDateTime", "dateTime"],
    ["valuePeriod", "Period"],
    ["valueAttachment", "Attachment"],
    ["valueReference", "Reference"],
  ],
  ObservationDefinition: [
    ["category", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["derivedFromCanonical", "canonical"],
    ["derivedFromUri", "uri"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["performerType", "CodeableConcept"],
    ["publisher", "string"],
    ["status", "code"],
    ["subject", "CodeableConcept"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  OperationDefinition: [
    ["affectsState", "boolean"],
    ["base", "canonical"],
    ["code", "code"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["instance", "boolean"],
    ["jurisdiction", "CodeableConcept"],
    ["kind", "code"],
    ["name", "string"],
    ["publisher", "string"],
    ["resource", "code"],
    ["status", "code"],
    ["system", "boolean"],
    ["title", "string"],
    ["type", "boolean"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  OperationOutcome: [["issue", "OperationOutcomeIssue"]],
  OperationOutcomeIssue: [
    ["code", "code"],
    ["details", "CodeableConcept"],
    ["diagnostics", "string"],
    ["expression", "string"],
    ["location", "string"],
    ["modifierExtension", "Extension"],
    ["severity", "code"],
  ],
  Organization: [
    ["active", "boolean"],
    ["description", "markdown"],
    ["identifier", "Identifier"],
    ["name", "string"],
    ["partOf", "Reference"],
    ["type", "CodeableConcept"],
  ],
  OrganizationAffiliation: [
    ["active", "boolean"],
    ["code", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["location", "Reference"],
    ["network", "Reference"],
    ["organization", "Reference"],
    ["participatingOrganization", "Reference"],
    ["period", "Period"],
    ["specialty", "CodeableConcept"],
  ],
  PackagedProductDefinition: [
    ["attachedDocument", "Reference"],
    ["containedItemQuantity", "Quantity"],
    ["copackagedIndicator", "boolean"],
    ["description", "markdown"],
    ["identifier", "Identifier"],
    ["legalStatusOfSupply", "PackagedProductDefinitionLegalStatusOfSupply"],
    ["manufacturer", "Reference"],
    ["marketingStatus", "MarketingStatus"],
    ["name", "string"],
    ["packageFor", "Reference"],
    ["packaging", "PackagedProductDefinitionPackaging"],
    ["status", "CodeableConcept"],
    ["statusDate", "dateTime"],
    ["type", "CodeableConcept"],
  ],
  PackagedProductDefinitionLegalStatusOfSupply: [
    ["code", "CodeableConcept"],
    ["jurisdiction", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  PackagedProductDefinitionPackaging: [
    ["alternateMaterial", "CodeableConcept"],
    ["componentPart", "boolean"],
    ["containedItem", "PackagedProductDefinitionPackagingContainedItem"],
    ["identifier", "Identifier"],
    ["manufacturer", "Reference"],
    ["material", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["property", "PackagedProductDefinitionPackagingProperty"],
    ["quantity", "integer"],
    ["shelfLifeStorage", "ProductShelfLife"],
    ["type", "CodeableConcept"],
  ],
  PackagedProductDefinitionPackagingContainedItem: [
    ["amount", "Quantity"],
    ["item", "CodeableReference"],
    ["modifierExtension", "Extension"],
  ],
  PackagedProductDefinitionPackagingProperty: [
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
    ["valueCodeableConcept", "CodeableConcept"],
    ["valueQuantity", "Quantity"],
    ["valueDate", "date"],
    ["valueBoolean", "boolean"],
    ["valueAttachment", "Attachment"],
  ],
  Patient: [
    ["active", "boolean"],
    ["address", "Address"],
    ["birthDate", "date"],
    ["deceasedBoolean", "boolean"],
    ["deceasedDateTime", "dateTime"],
    ["gender", "code"],
    ["identifier", "Identifier"],
    ["link", "PatientLink"],
    ["managingOrganization", "Reference"],
    ["name", "HumanName"],
    ["telecom", "ContactPoint"],
  ],
  PatientLink: [
    ["modifierExtension", "Extension"],
    ["other", "Reference"],
    ["type", "code"],
  ],
  PaymentNotice: [
    ["amount", "Money"],
    ["created", "dateTime"],
    ["payment", "Reference"],
    ["recipient", "Reference"],
    ["status", "code"],
  ],
  PaymentReconciliation: [
    ["amount", "Money"],
    ["created", "dateTime"],
    ["date", "date"],
    ["paymentIssuer", "Reference"],
    ["period", "Period"],
    ["status", "code"],
    ["type", "CodeableConcept"],
  ],
  Permission: [
    ["asserter", "Reference"],
    ["combining", "code"],
    ["date", "dateTime"],
    ["justification", "PermissionJustification"],
    ["rule", "PermissionRule"],
    ["status", "code"],
    ["validity", "Period"],
  ],
  PermissionJustification: [
    ["basis", "CodeableConcept"],
    ["evidence", "Reference"],
    ["modifierExtension", "Extension"],
  ],
  PermissionRule: [
    ["activity", "PermissionRuleActivity"],
    ["data", "PermissionRuleData"],
    ["limit", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["type", "code"],
  ],
  PermissionRuleActivity: [
    ["action", "CodeableConcept"],
    ["actor", "Reference"],
    ["modifierExtension", "Extension"],
    ["purpose", "CodeableConcept"],
  ],
  PermissionRuleData: [
    ["expression", "Expression"],
    ["modifierExtension", "Extension"],
    ["period", "Period"],
    ["resource", "PermissionRuleDataResource"],
    ["security", "Coding"],
  ],
  PermissionRuleDataResource: [
    ["meaning", "code"],
    ["modifierExtension", "Extension"],
    ["reference", "Reference"],
  ],
  Person: [
    ["active", "boolean"],
    ["address", "Address"],
    ["birthDate", "date"],
    ["deceasedBoolean", "boolean"],
    ["deceasedDateTime", "dateTime"],
    ["gender", "code"],
    ["identifier", "Identifier"],
    ["managingOrganization", "Reference"],
    ["name", "HumanName"],
    ["telecom", "ContactPoint"],
  ],
  PlanDefinition: [
    ["asNeededBoolean", "boolean"],
    ["asNeededCodeableConcept", "CodeableConcept"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["description", "markdown"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["type", "CodeableConcept"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  Practitioner: [
    ["active", "boolean"],
    ["address", "Address"],
    ["birthDate", "date"],
    ["deceasedBoolean", "boolean"],
    ["deceasedDateTime", "dateTime"],
    ["gender", "code"],
    ["identifier", "Identifier"],
    ["name", "HumanName"],
    ["telecom", "ContactPoint"],
  ],
  PractitionerRole: [
    ["active", "boolean"],
    ["code", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["location", "Reference"],
    ["organization", "Reference"],
    ["period", "Period"],
    ["practitioner", "Reference"],
    ["specialty", "CodeableConcept"],
  ],
  Procedure: [
    ["basedOn", "Reference"],
    ["bodySite", "CodeableConcept"],
    ["category", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["encounter", "Reference"],
    ["focus", "Reference"],
    ["identifier", "Identifier"],
    ["instantiatesCanonical", "canonical"],
    ["instantiatesUri", "uri"],
    ["location", "Reference"],
    ["occurrenceDateTime", "dateTime"],
    ["occurrencePeriod", "Period"],
    ["occurrenceString", "string"],
    ["occurrenceAge", "Age"],
    ["occurrenceRange", "Range"],
    ["occurrenceTiming", "Timing"],
    ["outcome", "CodeableConcept"],
    ["partOf", "Reference"],
    ["performer", "ProcedurePerformer"],
    ["reason", "CodeableReference"],
    ["recorded", "dateTime"],
    ["recorder", "Reference"],
    ["reportedBoolean", "boolean"],
    ["reportedReference", "Reference"],
    ["status", "code"],
    ["statusReason", "CodeableConcept"],
    ["subject", "Reference"],
  ],
  ProcedurePerformer: [
    ["actor", "Reference"],
    ["function", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  Provenance: [
    ["agent", "ProvenanceAgent"],
    ["entity", "ProvenanceEntity"],
    ["recorded", "instant"],
    ["target", "Reference"],
  ],
  ProvenanceAgent: [
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
    ["who", "Reference"],
  ],
  ProvenanceEntity: [
    ["modifierExtension", "Extension"],
    ["role", "code"],
    ["what", "Reference"],
  ],
  Questionnaire: [
    ["code", "Coding"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["derivedFrom", "canonical"],
    ["description", "markdown"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["subjectType", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  QuestionnaireResponse: [
    ["author", "Reference"],
    ["authored", "dateTime"],
    ["basedOn", "Reference"],
    ["encounter", "Reference"],
    ["identifier", "Identifier"],
    ["partOf", "Reference"],
    ["questionnaire", "canonical"],
    ["source", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  RegulatedAuthorization: [
    ["attachedDocument", "Reference"],
    ["basis", "CodeableConcept"],
    ["case", "RegulatedAuthorizationCase"],
    ["description", "markdown"],
    ["holder", "Reference"],
    ["identifier", "Identifier"],
    ["indication", "CodeableReference"],
    ["intendedUse", "CodeableConcept"],
    ["region", "CodeableConcept"],
    ["regulator", "Reference"],
    ["status", "CodeableConcept"],
    ["statusDate", "dateTime"],
    ["subject", "Reference"],
    ["type", "CodeableConcept"],
    ["validityPeriod", "Period"],
  ],
  RegulatedAuthorizationCase: [
    ["datePeriod", "Period"],
    ["dateDateTime", "dateTime"],
    ["identifier", "Identifier"],
    ["modifierExtension", "Extension"],
    ["status", "CodeableConcept"],
    ["type", "CodeableConcept"],
  ],
  RelatedPerson: [
    ["active", "boolean"],
    ["address", "Address"],
    ["birthDate", "date"],
    ["gender", "code"],
    ["identifier", "Identifier"],
    ["name", "HumanName"],
    ["patient", "Reference"],
    ["relationship", "CodeableConcept"],
    ["telecom", "ContactPoint"],
  ],
  RequestOrchestration: [
    ["code", "CodeableConcept"],
    ["groupIdentifier", "Identifier"],
    ["identifier", "Identifier"],
    ["instantiatesCanonical", "canonical"],
    ["instantiatesUri", "uri"],
    ["intent", "code"],
    ["priority", "code"],
    ["status", "code"],
  ],
  Requirements: [
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["derivedFrom", "canonical"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  ResearchStudy: [
    ["condition", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["keyword", "CodeableConcept"],
    ["partOf", "Reference"],
    ["period", "Period"],
    ["phase", "CodeableConcept"],
    ["primaryPurposeType", "CodeableConcept"],
    ["protocol", "Reference"],
    ["recruitment", "ResearchStudyRecruitment"],
    ["region", "CodeableConcept"],
    ["result", "Reference"],
    ["site", "Reference"],
    ["status", "code"],
    ["studyDesign", "CodeableConcept"],
    ["title", "string"],
    ["whyStopped", "CodeableConcept"],
  ],
  ResearchStudyRecruitment: [
    ["actualGroup", "Reference"],
    ["modifierExtension", "Extension"],
  ],
  ResearchSubject: [
    ["identifier", "Identifier"],
    ["period", "Period"],
    ["status", "code"],
    ["study", "Reference"],
    ["subject", "Reference"],
  ],
  RiskAssessment: [
    ["code", "CodeableConcept"],
    ["condition", "Reference"],
    ["encounter", "Reference"],
    ["identifier", "Identifier"],
    ["method", "CodeableConcept"],
    ["occurrenceDateTime", "dateTime"],
    ["occurrencePeriod", "Period"],
    ["performer", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  Schedule: [
    ["active", "boolean"],
    ["actor", "Reference"],
    ["identifier", "Identifier"],
    ["name", "string"],
    ["planningHorizon", "Period"],
    ["serviceCategory", "CodeableConcept"],
    ["serviceType", "CodeableReference"],
    ["specialty", "CodeableConcept"],
  ],
  SearchParameter: [
    ["base", "code"],
    ["code", "code"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["description", "markdown"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["type", "code"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  ServiceRequest: [
    ["asNeededBoolean", "boolean"],
    ["asNeededCodeableConcept", "CodeableConcept"],
    ["authoredOn", "dateTime"],
    ["basedOn", "Reference"],
    ["bodySite", "CodeableConcept"],
    ["bodyStructure", "Reference"],
    ["category", "CodeableConcept"],
    ["code", "CodeableReference"],
    ["doNotPerform", "boolean"],
    ["encounter", "Reference"],
    ["focus", "Reference"],
    ["identifier", "Identifier"],
    ["instantiatesCanonical", "canonical"],
    ["instantiatesUri", "uri"],
    ["intent", "code"],
    ["location", "CodeableReference"],
    ["occurrenceDateTime", "dateTime"],
    ["occurrencePeriod", "Period"],
    ["occurrenceTiming", "Timing"],
    ["orderDetail", "ServiceRequestOrderDetail"],
    ["performer", "Reference"],
    ["performerType", "CodeableConcept"],
    ["priority", "code"],
    ["quantityQuantity", "Quantity"],
    ["quantityRatio", "Ratio"],
    ["quantityRange", "Range"],
    ["reason", "CodeableReference"],
    ["replaces", "Reference"],
    ["requester", "Reference"],
    ["requisition", "Identifier"],
    ["specimen", "Reference"],
    ["status", "code"],
    ["subject", "Reference"],
  ],
  ServiceRequestOrderDetail: [
    ["modifierExtension", "Extension"],
    ["parameter", "ServiceRequestOrderDetailParameter"],
  ],
  ServiceRequestOrderDetailParameter: [
    ["code", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["valueQuantity", "Quantity"],
    ["valueRatio", "Ratio"],
    ["valueRange", "Range"],
    ["valueBoolean", "boolean"],
    ["valueCodeableConcept", "CodeableConcept"],
    ["valueString", "string"],
    ["valuePeriod", "Period"],
  ],
  Slot: [
    ["appointmentType", "CodeableConcept"],
    ["end", "instant"],
    ["identifier", "Identifier"],
    ["schedule", "Reference"],
    ["serviceCategory", "CodeableConcept"],
    ["serviceType", "CodeableReference"],
    ["specialty", "CodeableConcept"],
    ["start", "instant"],
    ["status", "code"],
  ],
  Specimen: [
    ["accessionIdentifier", "Identifier"],
    ["combined", "code"],
    ["condition", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["receivedTime", "dateTime"],
    ["status", "code"],
    ["subject", "Reference"],
    ["type", "CodeableConcept"],
  ],
  SpecimenDefinition: [
    ["collection", "CodeableConcept"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["derivedFromCanonical", "canonical"],
    ["derivedFromUri", "uri"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["patientPreparation", "CodeableConcept"],
    ["publisher", "string"],
    ["status", "code"],
    ["subjectCodeableConcept", "CodeableConcept"],
    ["subjectReference", "Reference"],
    ["timeAspect", "string"],
    ["title", "string"],
    ["typeCollected", "CodeableConcept"],
    ["url", "uri"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  StructureDefinition: [
    ["abstract", "boolean"],
    ["baseDefinition", "canonical"],
    ["contact", "ContactDetail"],
    ["context", "StructureDefinitionContext"],
    ["contextInvariant", "string"],
    ["date", "dateTime"],
    ["derivation", "code"],
    ["experimental", "boolean"],
    ["fhirVersion", "code"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["keyword", "Coding"],
    ["kind", "code"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["type", "uri"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  StructureDefinitionContext: [
    ["expression", "string"],
    ["modifierExtension", "Extension"],
    ["type", "code"],
  ],
  StructureMap: [
    ["const", "StructureMapConst"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["experimental", "boolean"],
    ["group", "StructureMapGroup"],
    ["identifier", "Identifier"],
    ["import", "canonical"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["structure", "StructureMapStructure"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  StructureMapConst: [
    ["modifierExtension", "Extension"],
    ["name", "id"],
    ["value", "string"],
  ],
  StructureMapGroup: [
    ["documentation", "string"],
    ["extends", "id"],
    ["input", "StructureMapGroupInput"],
    ["modifierExtension", "Extension"],
    ["name", "id"],
    ["rule", "StructureMapGroupRule"],
    ["typeMode", "code"],
  ],
  StructureMapGroupInput: [
    ["mode", "code"],
    ["modifierExtension", "Extension"],
    ["name", "id"],
    ["type", "string"],
  ],
  StructureMapGroupRule: [
    ["dependent", "StructureMapGroupRuleDependent"],
    ["modifierExtension", "Extension"],
    ["name", "id"],
    ["source", "StructureMapGroupRuleSource"],
    ["target", "StructureMapGroupRuleTarget"],
  ],
  StructureMapGroupRuleDependent: [
    ["modifierExtension", "Extension"],
    ["name", "id"],
  ],
  StructureMapGroupRuleSource: [
    ["check", "string"],
    ["condition", "string"],
    ["context", "id"],
    ["defaultValue", "string"],
    ["element", "string"],
    ["listMode", "code"],
    ["logMessage", "string"],
    ["max", "string"],
    ["min", "integer"],
    ["modifierExtension", "Extension"],
    ["type", "string"],
    ["variable", "id"],
  ],
  StructureMapGroupRuleTarget: [
    ["context", "string"],
    ["element", "string"],
    ["listMode", "code"],
    ["listRuleId", "id"],
    ["modifierExtension", "Extension"],
    ["parameter", "StructureMapGroupRuleTargetParameter"],
    ["transform", "code"],
    ["variable", "id"],
  ],
  StructureMapGroupRuleTargetParameter: [
    ["modifierExtension", "Extension"],
    ["valueId", "id"],
    ["valueString", "string"],
    ["valueBoolean", "boolean"],
    ["valueInteger", "integer"],
    ["valueDecimal", "decimal"],
    ["valueDate", "date"],
    ["valueTime", "time"],
    ["valueDateTime", "dateTime"],
  ],
  StructureMapStructure: [
    ["alias", "string"],
    ["mode", "code"],
    ["modifierExtension", "Extension"],
    ["url", "canonical"],
  ],
  Subscription: [
    ["channelType", "Coding"],
    ["contact", "ContactPoint"],
    ["content", "code"],
    ["contentType", "code"],
    ["end", "instant"],
    ["endpoint", "url"],
    ["filterBy", "SubscriptionFilterBy"],
    ["heartbeatPeriod", "unsignedInt"],
    ["identifier", "Identifier"],
    ["managingEntity", "Reference"],
    ["maxCount", "positiveInt"],
    ["name", "string"],
    ["reason", "string"],
    ["status", "code"],
    ["timeout", "unsignedInt"],
    ["topic", "canonical"],
  ],
  SubscriptionFilterBy: [
    ["filterParameter", "string"],
    ["modifierExtension", "Extension"],
    ["resourceType", "uri"],
    ["value", "string"],
  ],
  SubscriptionStatus: [
    ["error", "CodeableConcept"],
    ["eventsSinceSubscriptionStart", "integer64"],
    ["status", "code"],
    ["subscription", "Reference"],
    ["topic", "canonical"],
    ["type", "code"],
  ],
  SubscriptionTopic: [
    ["canFilterBy", "SubscriptionTopicCanFilterBy"],
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["derivedFrom", "canonical"],
    ["effectivePeriod", "Period"],
    ["eventTrigger", "SubscriptionTopicEventTrigger"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["notificationShape", "SubscriptionTopicNotificationShape"],
    ["publisher", "string"],
    ["resourceTrigger", "SubscriptionTopicResourceTrigger"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  SubscriptionTopicCanFilterBy: [
    ["description", "markdown"],
    ["filterDefinition", "uri"],
    ["filterParameter", "string"],
    ["modifierExtension", "Extension"],
    ["resource", "uri"],
  ],
  SubscriptionTopicEventTrigger: [
    ["description", "markdown"],
    ["event", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["resource", "uri"],
  ],
  SubscriptionTopicNotificationShape: [
    ["include", "string"],
    ["modifierExtension", "Extension"],
    ["resource", "uri"],
    ["revInclude", "string"],
  ],
  SubscriptionTopicResourceTrigger: [
    ["description", "markdown"],
    ["fhirPathCriteria", "string"],
    ["modifierExtension", "Extension"],
    ["queryCriteria", "SubscriptionTopicResourceTriggerQueryCriteria"],
    ["resource", "uri"],
    ["supportedInteraction", "code"],
  ],
  SubscriptionTopicResourceTriggerQueryCriteria: [
    ["current", "string"],
    ["modifierExtension", "Extension"],
    ["previous", "string"],
    ["requireBoth", "boolean"],
    ["resultForCreate", "code"],
    ["resultForDelete", "code"],
  ],
  Substance: [
    ["category", "CodeableConcept"],
    ["code", "CodeableReference"],
    ["description", "markdown"],
    ["expiry", "dateTime"],
    ["identifier", "Identifier"],
    ["ingredient", "SubstanceIngredient"],
    ["instance", "boolean"],
    ["quantity", "Quantity"],
    ["status", "code"],
  ],
  SubstanceIngredient: [
    ["modifierExtension", "Extension"],
    ["quantity", "Ratio"],
    ["substanceCodeableConcept", "CodeableConcept"],
    ["substanceReference", "Reference"],
  ],
  SubstanceDefinition: [
    ["characterization", "SubstanceDefinitionCharacterization"],
    ["classification", "CodeableConcept"],
    ["code", "SubstanceDefinitionCode"],
    ["description", "markdown"],
    ["domain", "CodeableConcept"],
    ["grade", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["informationSource", "Reference"],
    ["manufacturer", "Reference"],
    ["moiety", "SubstanceDefinitionMoiety"],
    ["molecularWeight", "SubstanceDefinitionMolecularWeight"],
    ["name", "SubstanceDefinitionName"],
    ["note", "Annotation"],
    ["nucleicAcid", "Reference"],
    ["polymer", "Reference"],
    ["property", "SubstanceDefinitionProperty"],
    ["protein", "Reference"],
    ["referenceInformation", "Reference"],
    ["relationship", "SubstanceDefinitionRelationship"],
    ["sourceMaterial", "SubstanceDefinitionSourceMaterial"],
    ["status", "CodeableConcept"],
    ["structure", "SubstanceDefinitionStructure"],
    ["supplier", "Reference"],
    ["version", "string"],
  ],
  SubstanceDefinitionCharacterization: [
    ["description", "markdown"],
    ["file", "Attachment"],
    ["form", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["technique", "CodeableConcept"],
  ],
  SubstanceDefinitionCode: [
    ["code", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["note", "Annotation"],
    ["source", "Reference"],
    ["status", "CodeableConcept"],
    ["statusDate", "dateTime"],
  ],
  SubstanceDefinitionMoiety: [
    ["amountQuantity", "Quantity"],
    ["amountString", "string"],
    ["identifier", "Identifier"],
    ["measurementType", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["molecularFormula", "string"],
    ["name", "string"],
    ["opticalActivity", "CodeableConcept"],
    ["role", "CodeableConcept"],
    ["stereochemistry", "CodeableConcept"],
  ],
  SubstanceDefinitionMolecularWeight: [
    ["amount", "Quantity"],
    ["method", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
  ],
  SubstanceDefinitionName: [
    ["domain", "CodeableConcept"],
    ["jurisdiction", "CodeableConcept"],
    ["language", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["name", "string"],
    ["official", "SubstanceDefinitionNameOfficial"],
    ["preferred", "boolean"],
    ["source", "Reference"],
    ["status", "CodeableConcept"],
    ["type", "CodeableConcept"],
  ],
  SubstanceDefinitionNameOfficial: [
    ["authority", "CodeableConcept"],
    ["date", "dateTime"],
    ["modifierExtension", "Extension"],
    ["status", "CodeableConcept"],
  ],
  SubstanceDefinitionProperty: [
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
    ["valueCodeableConcept", "CodeableConcept"],
    ["valueQuantity", "Quantity"],
    ["valueDate", "date"],
    ["valueBoolean", "boolean"],
    ["valueAttachment", "Attachment"],
  ],
  SubstanceDefinitionRelationship: [
    ["amountQuantity", "Quantity"],
    ["amountRatio", "Ratio"],
    ["amountString", "string"],
    ["comparator", "CodeableConcept"],
    ["isDefining", "boolean"],
    ["modifierExtension", "Extension"],
    ["ratioHighLimitAmount", "Ratio"],
    ["source", "Reference"],
    ["substanceDefinitionReference", "Reference"],
    ["substanceDefinitionCodeableConcept", "CodeableConcept"],
    ["type", "CodeableConcept"],
  ],
  SubstanceDefinitionSourceMaterial: [
    ["countryOfOrigin", "CodeableConcept"],
    ["genus", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["part", "CodeableConcept"],
    ["species", "CodeableConcept"],
    ["type", "CodeableConcept"],
  ],
  SubstanceDefinitionStructure: [
    ["modifierExtension", "Extension"],
    ["molecularFormula", "string"],
    ["molecularFormulaByMoiety", "string"],
    ["opticalActivity", "CodeableConcept"],
    ["representation", "SubstanceDefinitionStructureRepresentation"],
    ["sourceDocument", "Reference"],
    ["stereochemistry", "CodeableConcept"],
    ["technique", "CodeableConcept"],
  ],
  SubstanceDefinitionStructureRepresentation: [
    ["document", "Reference"],
    ["format", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["representation", "string"],
    ["type", "CodeableConcept"],
  ],
  SubstanceNucleicAcid: [
    ["areaOfHybridisation", "string"],
    ["numberOfSubunits", "integer"],
    ["oligoNucleotideType", "CodeableConcept"],
    ["sequenceType", "CodeableConcept"],
    ["subunit", "SubstanceNucleicAcidSubunit"],
  ],
  SubstanceNucleicAcidSubunit: [
    ["fivePrime", "CodeableConcept"],
    ["length", "integer"],
    ["linkage", "SubstanceNucleicAcidSubunitLinkage"],
    ["modifierExtension", "Extension"],
    ["sequence", "string"],
    ["sequenceAttachment", "Attachment"],
    ["subunit", "integer"],
    ["sugar", "SubstanceNucleicAcidSubunitSugar"],
    ["threePrime", "CodeableConcept"],
  ],
  SubstanceNucleicAcidSubunitLinkage: [
    ["connectivity", "string"],
    ["identifier", "Identifier"],
    ["modifierExtension", "Extension"],
    ["name", "string"],
    ["residueSite", "string"],
  ],
  SubstanceNucleicAcidSubunitSugar: [
    ["identifier", "Identifier"],
    ["modifierExtension", "Extension"],
    ["name", "string"],
    ["residueSite", "string"],
  ],
  SubstancePolymer: [
    ["class", "CodeableConcept"],
    ["copolymerConnectivity", "CodeableConcept"],
    ["geometry", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["modification", "string"],
    ["monomerSet", "SubstancePolymerMonomerSet"],
    ["repeat", "SubstancePolymerRepeat"],
  ],
  SubstancePolymerMonomerSet: [
    ["modifierExtension", "Extension"],
    ["ratioType", "CodeableConcept"],
    ["startingMaterial", "SubstancePolymerMonomerSetStartingMaterial"],
  ],
  SubstancePolymerMonomerSetStartingMaterial: [
    ["amount", "Quantity"],
    ["category", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["isDefining", "boolean"],
    ["modifierExtension", "Extension"],
  ],
  SubstancePolymerRepeat: [
    ["averageMolecularFormula", "string"],
    ["modifierExtension", "Extension"],
    ["repeatUnit", "SubstancePolymerRepeatRepeatUnit"],
    ["repeatUnitAmountType", "CodeableConcept"],
  ],
  SubstancePolymerRepeatRepeatUnit: [
    ["amount", "integer"],
    [
      "degreeOfPolymerisation",
      "SubstancePolymerRepeatRepeatUnitDegreeOfPolymerisation",
    ],
    ["modifierExtension", "Extension"],
    ["orientation", "CodeableConcept"],
    [
      "structuralRepresentation",
      "SubstancePolymerRepeatRepeatUnitStructuralRepresentation",
    ],
    ["unit", "string"],
  ],
  SubstancePolymerRepeatRepeatUnitDegreeOfPolymerisation: [
    ["average", "integer"],
    ["high", "integer"],
    ["low", "integer"],
    ["modifierExtension", "Extension"],
    ["type", "CodeableConcept"],
  ],
  SubstancePolymerRepeatRepeatUnitStructuralRepresentation: [
    ["attachment", "Attachment"],
    ["format", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["representation", "string"],
    ["type", "CodeableConcept"],
  ],
  SubstanceProtein: [
    ["disulfideLinkage", "string"],
    ["numberOfSubunits", "integer"],
    ["sequenceType", "CodeableConcept"],
    ["subunit", "SubstanceProteinSubunit"],
  ],
  SubstanceProteinSubunit: [
    ["cTerminalModification", "string"],
    ["cTerminalModificationId", "Identifier"],
    ["length", "integer"],
    ["modifierExtension", "Extension"],
    ["nTerminalModification", "string"],
    ["nTerminalModificationId", "Identifier"],
    ["sequence", "string"],
    ["sequenceAttachment", "Attachment"],
    ["subunit", "integer"],
  ],
  SubstanceReferenceInformation: [
    ["comment", "string"],
    ["gene", "SubstanceReferenceInformationGene"],
    ["geneElement", "SubstanceReferenceInformationGeneElement"],
    ["target", "SubstanceReferenceInformationTarget"],
  ],
  SubstanceReferenceInformationGene: [
    ["gene", "CodeableConcept"],
    ["geneSequenceOrigin", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["source", "Reference"],
  ],
  SubstanceReferenceInformationGeneElement: [
    ["element", "Identifier"],
    ["modifierExtension", "Extension"],
    ["source", "Reference"],
    ["type", "CodeableConcept"],
  ],
  SubstanceReferenceInformationTarget: [
    ["amountQuantity", "Quantity"],
    ["amountRange", "Range"],
    ["amountString", "string"],
    ["amountType", "CodeableConcept"],
    ["interaction", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["organism", "CodeableConcept"],
    ["organismType", "CodeableConcept"],
    ["source", "Reference"],
    ["target", "Identifier"],
    ["type", "CodeableConcept"],
  ],
  SubstanceSourceMaterial: [
    ["countryOfOrigin", "CodeableConcept"],
    ["developmentStage", "CodeableConcept"],
    ["fractionDescription", "SubstanceSourceMaterialFractionDescription"],
    ["geographicalLocation", "string"],
    ["organism", "SubstanceSourceMaterialOrganism"],
    ["organismId", "Identifier"],
    ["organismName", "string"],
    ["parentSubstanceId", "Identifier"],
    ["parentSubstanceName", "string"],
    ["partDescription", "SubstanceSourceMaterialPartDescription"],
    ["sourceMaterialClass", "CodeableConcept"],
    ["sourceMaterialState", "CodeableConcept"],
    ["sourceMaterialType", "CodeableConcept"],
  ],
  SubstanceSourceMaterialFractionDescription: [
    ["fraction", "string"],
    ["materialType", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  SubstanceSourceMaterialOrganism: [
    ["author", "SubstanceSourceMaterialOrganismAuthor"],
    ["family", "CodeableConcept"],
    ["genus", "CodeableConcept"],
    ["hybrid", "SubstanceSourceMaterialOrganismHybrid"],
    ["intraspecificDescription", "string"],
    ["intraspecificType", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["organismGeneral", "SubstanceSourceMaterialOrganismOrganismGeneral"],
    ["species", "CodeableConcept"],
  ],
  SubstanceSourceMaterialOrganismAuthor: [
    ["authorDescription", "string"],
    ["authorType", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  SubstanceSourceMaterialOrganismHybrid: [
    ["hybridType", "CodeableConcept"],
    ["maternalOrganismId", "string"],
    ["maternalOrganismName", "string"],
    ["modifierExtension", "Extension"],
    ["paternalOrganismId", "string"],
    ["paternalOrganismName", "string"],
  ],
  SubstanceSourceMaterialOrganismOrganismGeneral: [
    ["class", "CodeableConcept"],
    ["kingdom", "CodeableConcept"],
    ["modifierExtension", "Extension"],
    ["order", "CodeableConcept"],
    ["phylum", "CodeableConcept"],
  ],
  SubstanceSourceMaterialPartDescription: [
    ["modifierExtension", "Extension"],
    ["part", "CodeableConcept"],
    ["partLocation", "CodeableConcept"],
  ],
  SupplyDelivery: [
    ["basedOn", "Reference"],
    ["occurrenceDateTime", "dateTime"],
    ["occurrencePeriod", "Period"],
    ["occurrenceTiming", "Timing"],
    ["partOf", "Reference"],
    ["status", "code"],
  ],
  SupplyRequest: [
    ["authoredOn", "dateTime"],
    ["basedOn", "Reference"],
    ["category", "CodeableConcept"],
    ["identifier", "Identifier"],
    ["item", "CodeableReference"],
    ["occurrenceDateTime", "dateTime"],
    ["occurrencePeriod", "Period"],
    ["occurrenceTiming", "Timing"],
    ["priority", "code"],
    ["quantity", "Quantity"],
    ["requester", "Reference"],
    ["status", "code"],
    ["supplier", "Reference"],
  ],
  Task: [
    ["basedOn", "Reference"],
    ["businessStatus", "CodeableConcept"],
    ["code", "CodeableConcept"],
    ["description", "string"],
    ["doNotPerform", "boolean"],
    ["encounter", "Reference"],
    ["executionPeriod", "Period"],
    ["focus", "Reference"],
    ["for", "Reference"],
    ["groupIdentifier", "Identifier"],
    ["instantiatesCanonical", "canonical"],
    ["instantiatesUri", "uri"],
    ["intent", "code"],
    ["lastModified", "dateTime"],
    ["location", "Reference"],
    ["owner", "Reference"],
    ["partOf", "Reference"],
    ["performer", "TaskPerformer"],
    ["requestedPeriod", "Period"],
    ["requester", "Reference"],
    ["status", "code"],
    ["statusReason", "CodeableReference"],
  ],
  TaskPerformer: [
    ["actor", "Reference"],
    ["function", "CodeableConcept"],
    ["modifierExtension", "Extension"],
  ],
  TerminologyCapabilities: [
    ["contact", "ContactDetail"],
    ["copyright", "markdown"],
    ["date", "dateTime"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["implementation", "TerminologyCapabilitiesImplementation"],
    ["jurisdiction", "CodeableConcept"],
    ["kind", "code"],
    ["lockedDate", "boolean"],
    ["name", "string"],
    ["publisher", "string"],
    ["software", "TerminologyCapabilitiesSoftware"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  TerminologyCapabilitiesImplementation: [
    ["description", "string"],
    ["modifierExtension", "Extension"],
    ["url", "url"],
  ],
  TerminologyCapabilitiesSoftware: [
    ["modifierExtension", "Extension"],
    ["name", "string"],
    ["version", "string"],
  ],
  TestPlan: [
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  TestReport: [
    ["identifier", "Identifier"],
    ["issued", "dateTime"],
    ["name", "string"],
    ["result", "code"],
    ["score", "decimal"],
    ["status", "code"],
    ["tester", "string"],
    ["testScript", "canonical"],
  ],
  TestScript: [
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  Transport: [
    ["basedOn", "Reference"],
    ["code", "CodeableConcept"],
    ["completionTime", "dateTime"],
    ["currentLocation", "Reference"],
    ["description", "string"],
    ["encounter", "Reference"],
    ["focus", "Reference"],
    ["for", "Reference"],
    ["groupIdentifier", "Identifier"],
    ["instantiatesCanonical", "canonical"],
    ["instantiatesUri", "uri"],
    ["intent", "code"],
    ["lastModified", "dateTime"],
    ["location", "Reference"],
    ["owner", "Reference"],
    ["partOf", "Reference"],
    ["requestedLocation", "Reference"],
    ["requester", "Reference"],
    ["status", "code"],
    ["statusReason", "CodeableConcept"],
  ],
  ValueSet: [
    ["contact", "ContactDetail"],
    ["date", "dateTime"],
    ["effectivePeriod", "Period"],
    ["experimental", "boolean"],
    ["identifier", "Identifier"],
    ["immutable", "boolean"],
    ["jurisdiction", "CodeableConcept"],
    ["name", "string"],
    ["publisher", "string"],
    ["status", "code"],
    ["title", "string"],
    ["url", "uri"],
    ["useContext", "UsageContext"],
    ["version", "string"],
    ["versionAlgorithmString", "string"],
    ["versionAlgorithmCoding", "Coding"],
  ],
  ValueSetComposeInclude: [
    ["filter", "ValueSetComposeIncludeFilter"],
    ["modifierExtension", "Extension"],
    ["system", "uri"],
    ["valueSet", "canonical"],
    ["version", "string"],
  ],
  ValueSetComposeIncludeFilter: [
    ["modifierExtension", "Extension"],
    ["op", "code"],
    ["property", "code"],
    ["value", "string"],
  ],
  VerificationResult: [
    ["failureAction", "CodeableConcept"],
    ["need", "CodeableConcept"],
    ["status", "code"],
    ["statusDate", "dateTime"],
    ["target", "Reference"],
    ["targetLocation", "string"],
    ["validationProcess", "CodeableConcept"],
    ["validationType", "CodeableConcept"],
  ],
  VisionPrescription: [
    ["created", "dateTime"],
    ["dateWritten", "dateTime"],
    ["lensSpecification", "VisionPrescriptionLensSpecification"],
    ["patient", "Reference"],
    ["prescriber", "Reference"],
    ["status", "code"],
  ],
  VisionPrescriptionLensSpecification: [
    ["eye", "code"],
    ["modifierExtension", "Extension"],
    ["product", "CodeableConcept"],
  ],
};

export function narrative<TResource extends AnyDomainResource>(
  resource: TResource,
  options?: NarrativeOptions | null | undefined,
): Narrative | undefined {
  const generator = NARRATIVE_GENERATORS?.[resource.resourceType];
  if (!generator) {
    return;
  }

  if (typeof generator === "function") {
    const result = generator(resource);
    if (typeof result === "string") {
      return {
        status: "generated",
        div: result,
      };
    }

    return result;
  }

  return {
    status: "generated",
    div: `<div xmlns="http://www.w3.org/1999/xhtml">${render(
      resource,
      generator,
      options,
    )}</div>`,
  };
}

function render(
  item: object,
  components: Array<NarrativeItemGenerator>,
  options: NarrativeOptions | null | undefined,
): string {
  return `<ul>${components
    .map((component) => {
      const [attribute, type] = component;

      const value = (item as any)[attribute];

      if (value == undefined) {
        return;
      }

      if (Array.isArray(value)) {
        if (value.length === 0) {
          return;
        }

        return `<li><span>${startCase(attribute)}: </span><ul>${value
          .map((i) => renderValue(i, type, options))
          .filter(Boolean)
          .map((r) => `<li>${r}</li>`)
          .join("")}</ul></li>`;
      }

      return `<li><span>${startCase(attribute).replaceAll(
        " Boolean",
        "",
      )}: </span>${renderValue(value, type, options)}</li>`;
    })
    .filter(Boolean)
    .join("")}</ul>`;
}

function renderValue(
  value: any,
  type: string,
  options: NarrativeOptions | null | undefined,
): string | undefined {
  const formatter = options?.formatter ?? Formatter.default;
  const narrativeGenerator = NARRATIVE_GENERATORS?.[type];
  if (typeof narrativeGenerator === "function") {
    const generated = narrativeGenerator(value);
    return typeof generated === "string" ? generated : generated.div;
  } else if (typeof narrativeGenerator === "object") {
    return render(value, narrativeGenerator, options);
  } else if (formatter.canFormat(type)) {
    return htmlEncode(formatter.format(type, value as never));
  }
}

function htmlEncode(value: string): string {
  return value.replaceAll(
    /[&<>\u00A0-\u9999]/g,
    (i) => "&#" + i.codePointAt(0) + ";",
  );
}
